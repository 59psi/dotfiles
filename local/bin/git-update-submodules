#!/usr/bin/env bash
set -eu

time=$(date +"%Y-%m-%d %H:%M:%S %z")

cd "$(git rev-parse --show-toplevel)"

git submodule sync --recursive -q &&
git submodule update --init --recursive -q &&
git submodule foreach --recursive -q "
  echo \$path &&
  git checkout -q master &&
  git pull -q --no-rebase --ff-only &&
  git --no-pager log --graph --decorate --oneline 'master@{${time}}..'
"
