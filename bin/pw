#!/usr/bin/env python

import sys
import re
import base64
import hashlib
import hmac
import getpass

def alnum(s):
    return re.sub('[^A-Za-z0-9]', '', s.decode())

def hmac_sha256(msg, key):
    return hmac.new(key, msg, hashlib.sha256).digest()

if __name__ == '__main__':
    if len(sys.argv) != 2:
        print('usage: pw <domain>')
        sys.exit(1)

    domain = sys.argv[1].encode()
    key = getpass.getpass('Passphrase: ').encode()

    print(alnum(base64.b64encode(hmac_sha256(domain, key)))[:16])
