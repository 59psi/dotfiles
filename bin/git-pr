#!/usr/bin/env bash -e
# git-pr: apply a GitHub pull request patch file to a new branch

if [[ -z "$1" ]]
then
	git show-branch --list | grep -E --color=never "pr/[0-9]+"
	exit 0
fi

git checkout -b pr/$(echo $1 | grep -Eo "[0-9]+") upstream/master --no-track
curl -# "$(echo $1 | grep -Eo ".+[0-9]+").patch" | git am -s -3
